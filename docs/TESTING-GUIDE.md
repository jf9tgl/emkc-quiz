# 動作テストガイド

## 🚀 テスト手順

### 1. 準備: 3 つのターミナルを開く

#### ターミナル 1: サーバー起動

```powershell
cd server
npm run dev
# または
bun dev
```

✅ 確認: `Server running on port 3001`

---

#### ターミナル 2: 管理画面起動

```powershell
cd admin
npm run dev
# または
bun dev
```

✅ 確認: `Ready on http://localhost:3000`

---

#### ターミナル 3: クライアント起動

```powershell
cd client
npm run dev
# または
bun dev
```

✅ 確認: `Ready on http://localhost:3002`

---

### 2. 接続確認

#### 2.1 管理画面

1. ブラウザで開く: `http://localhost:3000/admin`
2. 右上の接続状態: **✓ 接続済み** (緑) を確認
3. プレイヤーリストが表示されることを確認

#### 2.2 投影画面

1. 別のブラウザタブで開く: `http://localhost:3000/display`
2. 接続状態: **✓ 接続済み** を確認
3. グラデーション背景が表示されることを確認

#### 2.3 タブレットクライアント

1. 別のブラウザタブで開く: `http://localhost:3002`
2. 接続状態: **✓ 接続済み** (右上) を確認
3. プレイヤー選択ボタン (1〜5) が表示されることを確認

---

### 3. 機能テスト

#### Test 1: 問題出題

1. **管理画面** (`/admin`) で:

    - 問題: `テスト問題`
    - 答え: `テスト答え`
    - ヒント: `テストヒント`
    - **「問題開始」** ボタンをクリック

2. **投影画面** (`/display`) で確認:

    - ✅ 問題が表示される
    - ✅ 背景が変わる
    - ✅ クイズ進行中表示

3. **タブレット** (`http://localhost:3002`) で確認:
    - ✅ 「🔴 クイズ進行中」表示
    - ✅ ボタンが有効化される

---

#### Test 2: タブレットボタン押下

1. **タブレット画面** で:

    - プレイヤー番号 **1** を選択
    - 大型 **PUSH!** ボタンをタップ
    - ✅ 黄色フラッシュ + ⚡ エフェクト表示

2. **投影画面** で確認:

    - ✅ Player 1 のカードが拡大表示
    - ✅ 「1 位」バッジ表示
    - ✅ アニメーション表示

3. **管理画面** で確認:
    - ✅ 押下順序に「1. Player 1」表示
    - ✅ プレイヤーリストで強調表示

---

#### Test 3: 正解/不正解

1. **管理画面** で:

    - **「正解」** ボタンをクリック

2. **投影画面** で確認:

    - ✅ Player 1 のスコアが +1
    - ✅ 正解アニメーション (緑フラッシュ)

3. **タブレット** で確認:
    - ✅ スコア表示が更新される
    - ✅ ボタンが無効化される

---

#### Test 4: スコア調整

1. **管理画面** で:

    - Player 2 の **+** ボタンをクリック
    - Player 3 の **-** ボタンをクリック

2. **全画面** で確認:
    - ✅ Player 2 のスコアが +1
    - ✅ Player 3 のスコアが -1
    - ✅ リアルタイムで反映される

---

#### Test 5: 全員リセット

1. **管理画面** で:

    - 右上の **「全員のスコアをリセット」** ボタンをクリック

2. **全画面** で確認:
    - ✅ 全プレイヤーのスコアが 0 になる

---

#### Test 6: ヒント/答え表示

1. **管理画面** で:

    - **「ヒント表示」** チェックボックスを ON

2. **投影画面** で確認:

    - ✅ ヒントが表示される

3. **管理画面** で:

    - **「答え表示」** チェックボックスを ON

4. **投影画面** で確認:
    - ✅ 答えが表示される

---

#### Test 7: プレイヤー名編集

1. **管理画面** で:

    - Player 1 の鉛筆アイコンをクリック
    - 名前を変更: `田中太郎`
    - Enter または ✓ で確定

2. **全画面** で確認:
    - ✅ Player 1 の名前が「田中太郎」に変更される
    - ✅ タブレットでも更新される

---

#### Test 8: 複数タブレット同時押下

1. **タブレット 1** で:

    - Player 1 を選択してボタン準備

2. **タブレット 2** (別ブラウザタブ) で:

    - Player 2 を選択してボタン準備

3. **問題開始後**:

    - Player 2 が先にボタンを押す

4. **タブレット 1** で:

    - ✅ ボタンが無効化される (既に誰かが押している)

5. **投影画面** で確認:
    - ✅ Player 2 のみが拡大表示
    - ✅ 押下順序: 「1. Player 2」

---

### 4. エラーケーステスト

#### Test 9: サーバー切断

1. サーバー (ターミナル 1) を **Ctrl+C** で停止

2. **管理画面とタブレット** で確認:

    - ✅ 接続状態が **✗ 未接続** (赤) になる

3. サーバーを再起動:

    ```powershell
    cd server
    npm run dev
    ```

4. **全画面** で確認:
    - ✅ 自動再接続される
    - ✅ 接続状態が **✓ 接続済み** (緑) になる

---

#### Test 10: 早押し済み時の押下

1. 問題開始後、Player 1 がボタン押下

2. **タブレット** (Player 2) で:
    - ボタンを押そうとする
    - ✅ ボタンが無効化されている
    - ✅ 「押下済み」表示

---

### 5. チェックリスト

-   [ ] サーバー起動 (port 3001)
-   [ ] 管理画面起動 (port 3000)
-   [ ] クライアント起動 (port 3002)
-   [ ] 管理画面接続確認
-   [ ] 投影画面接続確認
-   [ ] タブレット接続確認
-   [ ] 問題出題機能
-   [ ] タブレットボタン押下
-   [ ] 正解/不正解処理
-   [ ] スコア調整 (±1)
-   [ ] 全員リセット
-   [ ] ヒント/答え表示
-   [ ] プレイヤー名編集
-   [ ] 複数タブレット連携
-   [ ] 自動再接続

---

## 🐛 トラブルシューティング

### 問題: 接続できない

**解決策:**

1. サーバーが起動しているか確認
2. ポートが競合していないか確認
3. `.env.local` の `NEXT_PUBLIC_SERVER_URL` を確認

### 問題: タブレットボタンが反応しない

**解決策:**

1. プレイヤーを選択しているか確認
2. クイズが進行中か確認 (管理画面で問題開始)
3. 既に誰かが押していないか確認

### 問題: スコアが更新されない

**解決策:**

1. Socket.IO 接続を確認 (ブラウザコンソール)
2. サーバーログを確認
3. ページをリロード

---

## ✅ テスト完了後

全てのテストが通過したら:

1. 各ターミナルで **Ctrl+C** でサーバーを停止
2. デプロイ準備へ進む (PROJECT-RESTRUCTURE.md 参照)

---

## 📝 テスト結果記録

| テスト項目               | 結果 | 備考 |
| ------------------------ | ---- | ---- |
| Test 1: 問題出題         | [ ]  |      |
| Test 2: ボタン押下       | [ ]  |      |
| Test 3: 正解/不正解      | [ ]  |      |
| Test 4: スコア調整       | [ ]  |      |
| Test 5: 全員リセット     | [ ]  |      |
| Test 6: ヒント/答え表示  | [ ]  |      |
| Test 7: プレイヤー名編集 | [ ]  |      |
| Test 8: 複数タブレット   | [ ]  |      |
| Test 9: サーバー切断     | [ ]  |      |
| Test 10: 早押し済み      | [ ]  |      |

# タブレット早押しボタンページ

## 概要

このページは、プレイヤーがタブレットやスマートフォンから早押しボタンを操作するための専用インターフェースです。

## URL

```
http://[サーバーIP]:3000/button
```

例: `http://192.168.1.100:3000/button`

## 機能

### 主要機能

1. **大型ボタン表示**
   - プレイヤーごとに色分けされた大きなボタン
   - タップしやすい大きさ（モバイル最適化）

2. **リアルタイム状態同期**
   - プレイヤー名の表示
   - 現在のスコア表示
   - 押下状態のリアルタイム更新

3. **視覚的フィードバック**
   - ボタンタップ時のアニメーション
   - 押下済み状態の表示
   - 順位の表示（1位、2位など）

4. **接続状態監視**
   - 右上に接続状態インジケーター表示
   - 切断時の警告表示

## UI構成

### レイアウト

```
┌────────────────────────────────────────┐
│  早押しボタン              [接続状態]  │
│  問題が出題されています！              │
├────────────────────────────────────────┤
│                                        │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐│
│  │    1     │  │    2     │  │    3     ││
│  │ Player 1 │  │ Player 2 │  │ Player 3 ││
│  │   0pt    │  │  10pt    │  │  20pt    ││
│  └──────────┘  └──────────┘  └──────────┘│
│                                        │
│  ┌──────────┐  ┌──────────┐            │
│  │    4     │  │    5     │            │
│  │ Player 4 │  │ Player 5 │            │
│  │   0pt    │  │  10pt    │            │
│  └──────────┘  └──────────┘            │
│                                        │
├────────────────────────────────────────┤
│       3人が回答しています              │
└────────────────────────────────────────┘
```

### ボタンの色分け

| Player | 色 | グラデーション |
|--------|-----|---------------|
| 1 | 赤 (Red) | `from-red-500 to-red-700` |
| 2 | 青 (Blue) | `from-blue-500 to-blue-700` |
| 3 | 緑 (Green) | `from-green-500 to-green-700` |
| 4 | 黄 (Yellow) | `from-yellow-500 to-yellow-700` |
| 5 | 紫 (Purple) | `from-purple-500 to-purple-700` |
| 6 | ピンク (Pink) | `from-pink-500 to-pink-700` |

### 状態遷移

```
[待機中]
  ↓ クイズ開始 (isActive = true)
[有効状態]
  ↓ ボタンタップ
[押下中（アニメーション 0.3秒）]
  ↓
[無効状態 + 順位表示]
  ↓ クイズ終了
[待機中]
```

## レスポンシブデザイン

### ブレークポイント

- **モバイル（< 768px）**: 1列表示
- **タブレット（768px - 1024px）**: 2列表示
- **デスクトップ（> 1024px）**: 3列表示

### 推奨デバイス

- **最小画面サイズ**: 5インチ（スマートフォン）
- **推奨画面サイズ**: 7インチ以上（タブレット）
- **最適画面サイズ**: 10インチ（タブレット）

## 技術仕様

### 依存関係

- **React 19**: UIフレームワーク
- **Next.js 15**: アプリケーションフレームワーク
- **Framer Motion**: アニメーションライブラリ
- **Socket.IO Client**: WebSocket通信
- **Zustand**: 状態管理
- **Tailwind CSS**: スタイリング

### WebSocket イベント

#### 送信イベント

```typescript
// ボタン押下
socketManager.emit("pressButton", {
    buttonId: number,    // 1-6
    timestamp: number    // Date.now()
});
```

#### 受信イベント

```typescript
// 状態更新
socket.on("state", (state: QuizState) => {
    // プレイヤー情報、スコア、押下状態などを更新
});

// ボタン押下イベント（全クライアントに通知）
socket.on("buttonPressed", (data: { buttonId: number; timestamp: number }) => {
    // ボタン押下の確認（効果音再生など）
});
```

### 主要コンポーネント

#### ButtonPage

メインコンポーネント

**Props**: なし

**State**:
- `pressedButtonId`: 押下アニメーション用の一時状態

**Hooks**:
- `useQuizStore()`: グローバル状態管理

**主要関数**:
- `handleButtonPress(playerId)`: ボタン押下処理
- `getButtonColor(playerId)`: プレイヤーの色を取得
- `isPlayerPressed(playerId)`: 押下状態を確認
- `getPlayerOrder(playerId)`: 順位を取得

## 使用例

### 基本的な使い方

1. タブレットでURLにアクセス
2. 接続状態が「接続中」になるまで待機
3. 司会者が問題を出題（ボタンが有効化）
4. 自分のボタンをタップ
5. 順位が表示される
6. 司会者が正解/不正解を判定
7. 次の問題を待つ

### デモ用セットアップ

```bash
# サーバー起動
cd server
npm run dev

# フロントエンド起動
cd frontend
npm run dev

# ブラウザで確認
open http://localhost:3000/button
```

## トラブルシューティング

### ボタンが押せない

**症状**: ボタンをタップしても反応しない

**確認事項**:
1. クイズがアクティブか（問題が出題されているか）
2. 既にボタンを押していないか
3. 接続状態が「接続中」か

**解決策**:
- 問題を出題してもらう
- 次の問題まで待つ
- ページをリロード

### 接続できない

**症状**: 「サーバーに接続していません」と表示される

**確認事項**:
1. サーバーが起動しているか
2. 同じWi-Fiネットワークに接続しているか
3. IPアドレスが正しいか
4. ファイアウォールでポート3001が開いているか

**解決策**:
```bash
# サーバーの起動確認
curl http://localhost:3001

# IPアドレスの確認
ipconfig  # Windows
ifconfig  # Mac/Linux
```

### スコアが更新されない

**症状**: ボタンを押してもスコアが変わらない

**確認事項**:
1. WebSocket接続が確立されているか
2. サーバーとの同期が取れているか

**解決策**:
- ページをリロード（Ctrl+R / Cmd+R）
- ブラウザのキャッシュをクリア

## パフォーマンス

### 最適化

- **仮想化**: 大量のプレイヤーには対応していない（最大6人）
- **メモ化**: 不要な再レンダリングを防止
- **アニメーション**: GPU加速を使用（transform, opacity）
- **WebSocket**: 低遅延双方向通信

### 測定値（ローカルネットワーク）

- **初期読み込み**: < 1秒
- **ボタン押下遅延**: < 100ms
- **状態同期遅延**: < 50ms

## 今後の拡張

### 予定されている機能

- [ ] 全画面表示モード
- [ ] バイブレーションフィードバック（モバイル）
- [ ] カスタムテーマ
- [ ] 押下履歴の表示
- [ ] プレイヤーごとの統計情報

### 検討中の機能

- プログレスバー（制限時間表示）
- プレイヤーアバター表示
- 音声フィードバック（効果音）
- オフラインモード（PWA）

## 参考リンク

- [タブレットシステム設計書](../../../docs/tablet-system-design.md)
- [使用ガイド](../../../docs/TABLET-BUTTON-USAGE.md)
- [メインREADME](../../../README.md)

---

**作成日**: 2025-10-16
**バージョン**: 1.0.0
